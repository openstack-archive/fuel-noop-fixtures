apache::listen { '10.108.0.6:8888' :
}

apache::listen { '127.0.0.1:80' :
}

apache::listen { '192.168.0.3:35357' :
}

apache::listen { '192.168.0.3:5000' :
}

apache::listen { '192.168.0.3:80' :
}

apache::mod { 'actions' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'alias' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'auth_basic' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'auth_digest' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authn_alias' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authn_anon' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authn_dbm' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authn_default' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authn_file' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authz_dbm' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authz_default' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authz_groupfile' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authz_host' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authz_owner' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'authz_user' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'autoindex' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'cache' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'dav' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'dav_fs' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'deflate' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'dir' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'env' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'expires' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'ext_filter' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'headers' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'include' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'log_config' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'logio' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'mime' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'mime_magic' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'negotiation' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'rewrite' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'setenvif' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'speling' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'substitute' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'suexec' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'usertrack' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'version' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'vhost_alias' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::mod { 'wsgi' :
  lib_path       => 'modules',
  package_ensure => 'present',
}

apache::vhost { 'default-ssl' :
  ensure               => 'absent',
  access_log           => true,
  access_log_env_var   => false,
  access_log_file      => 'ssl_access_log',
  access_log_format    => false,
  access_log_pipe      => false,
  access_log_syslog    => false,
  add_listen           => true,
  additional_includes  => [  ],
  apache_version       => '2.2',
  block                => [  ],
  default_vhost        => false,
  directoryindex       => '',
  docroot              => '/var/www/html',
  docroot_group        => 'root',
  docroot_owner        => 'root',
  error_documents      => [  ],
  error_log            => true,
  ip_based             => false,
  logroot              => '/var/log/httpd',
  logroot_ensure       => 'directory',
  manage_docroot       => false,
  no_proxy_uris        => [  ],
  no_proxy_uris_match  => [  ],
  options              => [ 'Indexes', 'FollowSymLinks', 'MultiViews' ],
  override             => 'None',
  php_admin_flags      => {  },
  php_admin_values     => {  },
  php_flags            => {  },
  php_values           => {  },
  port                 => '443',
  priority             => '15',
  proxy_error_override => false,
  proxy_preserve_host  => false,
  redirect_source      => '/',
  scriptalias          => '/var/www/cgi-bin',
  scriptaliases        => { 'alias' => '/cgi-bin', 'path' => '/var/www/cgi-bin' },
  serveradmin          => 'root@localhost',
  serveraliases        => [  ],
  servername           => 'default-ssl',
  setenv               => [  ],
  setenvif             => [  ],
  ssl                  => true,
  ssl_cert             => '/etc/pki/tls/certs/localhost.crt',
  ssl_certs_dir        => '/etc/pki/tls/certs',
  ssl_key              => '/etc/pki/tls/private/localhost.key',
  ssl_proxyengine      => false,
  suphp_addhandler     => 'php5-script',
  suphp_engine         => 'off',
  vhost_name           => '*',
  virtual_docroot      => false,
}

apache::vhost { 'default' :
  ensure               => 'absent',
  access_log           => true,
  access_log_env_var   => false,
  access_log_file      => 'access_log',
  access_log_format    => false,
  access_log_pipe      => false,
  access_log_syslog    => false,
  add_listen           => true,
  additional_includes  => [  ],
  apache_version       => '2.2',
  block                => [  ],
  default_vhost        => false,
  directoryindex       => '',
  docroot              => '/var/www/html',
  docroot_group        => 'root',
  docroot_owner        => 'root',
  error_documents      => [  ],
  error_log            => true,
  ip_based             => false,
  logroot              => '/var/log/httpd',
  logroot_ensure       => 'directory',
  manage_docroot       => false,
  no_proxy_uris        => [  ],
  no_proxy_uris_match  => [  ],
  options              => [ 'Indexes', 'FollowSymLinks', 'MultiViews' ],
  override             => 'None',
  php_admin_flags      => {  },
  php_admin_values     => {  },
  php_flags            => {  },
  php_values           => {  },
  port                 => '80',
  priority             => '15',
  proxy_error_override => false,
  proxy_preserve_host  => false,
  redirect_source      => '/',
  scriptalias          => '/var/www/cgi-bin',
  scriptaliases        => { 'alias' => '/cgi-bin', 'path' => '/var/www/cgi-bin' },
  serveradmin          => 'root@localhost',
  serveraliases        => [  ],
  servername           => 'default',
  setenv               => [  ],
  setenvif             => [  ],
  ssl                  => false,
  ssl_cert             => '/etc/pki/tls/certs/localhost.crt',
  ssl_certs_dir        => '/etc/pki/tls/certs',
  ssl_key              => '/etc/pki/tls/private/localhost.key',
  ssl_proxyengine      => false,
  suphp_addhandler     => 'php5-script',
  suphp_engine         => 'off',
  vhost_name           => '*',
  virtual_docroot      => false,
}

apache::vhost { 'horizon_ssl_vhost' :
  ensure                      => 'absent',
  access_log                  => true,
  access_log_env_var          => false,
  access_log_file             => 'horizon_ssl_access.log',
  access_log_format           => false,
  access_log_pipe             => false,
  access_log_syslog           => false,
  add_listen                  => false,
  additional_includes         => [  ],
  aliases                     => { 'alias' => '/dashboard/static', 'path' => '/usr/share/openstack-dashboard/static' },
  apache_version              => '2.2',
  block                       => [  ],
  custom_fragment             => '
<Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    <IfModule mod_headers.c>
      # Make sure proxies don\'t deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
    </IfModule>
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

<Directory /usr/share/openstack-dashboard/static>
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access 6 month"
  </IfModule>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

',
  default_vhost               => true,
  directoryindex              => '',
  docroot                     => '/var/www/',
  docroot_group               => 'root',
  docroot_owner               => 'root',
  error_documents             => [  ],
  error_log                   => true,
  error_log_file              => 'horizon_ssl_error.log',
  headers                     => [ 'set X-XSS-Protection "1; mode=block"', 'set X-Content-Type-Options nosniff', 'always append X-Frame-Options SAMEORIGIN' ],
  ip                          => '192.168.0.3',
  ip_based                    => true,
  logroot                     => '/var/log/httpd',
  logroot_ensure              => 'directory',
  manage_docroot              => true,
  no_proxy_uris               => [  ],
  no_proxy_uris_match         => [  ],
  options                     => '-Indexes',
  override                    => 'None',
  php_admin_flags             => {  },
  php_admin_values            => {  },
  php_flags                   => {  },
  php_values                  => {  },
  port                        => '443',
  priority                    => false,
  proxy_error_override        => false,
  proxy_preserve_host         => false,
  redirect_source             => '/',
  redirectmatch_dest          => '/dashboard',
  redirectmatch_regexp        => '^/$',
  redirectmatch_status        => 'permanent',
  scriptaliases               => [  ],
  serveraliases               => 'node-129.test.domain.local',
  servername                  => 'node-129.test.domain.local',
  setenv                      => [  ],
  setenvif                    => 'X-Forwarded-Proto https HTTPS=1',
  ssl                         => true,
  ssl_cert                    => '/etc/pki/tls/certs/localhost.crt',
  ssl_certs_dir               => '/etc/pki/tls/certs',
  ssl_key                     => '/etc/pki/tls/private/localhost.key',
  ssl_proxyengine             => false,
  suphp_addhandler            => 'php5-script',
  suphp_engine                => 'off',
  vhost_name                  => '*',
  virtual_docroot             => false,
  wsgi_daemon_process         => 'horizon-ssl',
  wsgi_daemon_process_options => { 'group' => 'apache', 'processes' => '4', 'threads' => '15', 'user' => 'apache' },
  wsgi_import_script          => '/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi',
  wsgi_process_group          => 'horizon-ssl',
  wsgi_script_aliases         => { '/dashboard' => '/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi' },
}

apache::vhost { 'horizon_vhost' :
  ensure                      => 'present',
  access_log                  => true,
  access_log_env_var          => false,
  access_log_file             => 'horizon_access.log',
  access_log_format           => false,
  access_log_pipe             => false,
  access_log_syslog           => false,
  add_listen                  => false,
  additional_includes         => [  ],
  aliases                     => { 'alias' => '/dashboard/static', 'path' => '/usr/share/openstack-dashboard/static' },
  apache_version              => '2.2',
  block                       => [  ],
  custom_fragment             => '
<Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    <IfModule mod_headers.c>
      # Make sure proxies don\'t deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
    </IfModule>
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

<Directory /usr/share/openstack-dashboard/static>
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access 6 month"
  </IfModule>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

',
  default_vhost               => true,
  directoryindex              => '',
  docroot                     => '/var/www/',
  docroot_group               => 'root',
  docroot_owner               => 'root',
  error_documents             => [  ],
  error_log                   => true,
  error_log_file              => 'horizon_error.log',
  headers                     => [ 'set X-XSS-Protection "1; mode=block"', 'set X-Content-Type-Options nosniff', 'always append X-Frame-Options SAMEORIGIN' ],
  ip                          => '192.168.0.3',
  ip_based                    => true,
  logroot                     => '/var/log/httpd',
  logroot_ensure              => 'directory',
  manage_docroot              => true,
  no_proxy_uris               => [  ],
  no_proxy_uris_match         => [  ],
  options                     => '-Indexes',
  override                    => 'None',
  php_admin_flags             => {  },
  php_admin_values            => {  },
  php_flags                   => {  },
  php_values                  => {  },
  port                        => '80',
  priority                    => false,
  proxy_error_override        => false,
  proxy_preserve_host         => false,
  redirect_source             => '/',
  redirectmatch_dest          => '/dashboard',
  redirectmatch_regexp        => '^/$',
  redirectmatch_status        => 'permanent',
  scriptaliases               => [  ],
  serveraliases               => 'node-129.test.domain.local',
  servername                  => 'node-129.test.domain.local',
  setenv                      => [  ],
  setenvif                    => 'X-Forwarded-Proto https HTTPS=1',
  ssl                         => false,
  ssl_cert                    => '/etc/pki/tls/certs/localhost.crt',
  ssl_certs_dir               => '/etc/pki/tls/certs',
  ssl_key                     => '/etc/pki/tls/private/localhost.key',
  ssl_proxyengine             => false,
  suphp_addhandler            => 'php5-script',
  suphp_engine                => 'off',
  vhost_name                  => '*',
  virtual_docroot             => false,
  wsgi_daemon_process         => 'dashboard',
  wsgi_daemon_process_options => { 'group' => 'apache', 'processes' => '4', 'threads' => '15', 'user' => 'apache' },
  wsgi_import_script          => '/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi',
  wsgi_process_group          => 'dashboard',
  wsgi_script_aliases         => { '/dashboard' => '/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi' },
}

class { 'Apache::Default_confd_files' :
  all => true,
}

class { 'Apache::Default_mods' :
  all            => true,
  apache_version => '2.2',
}

class { 'Apache::Mod::Actions' :
}

class { 'Apache::Mod::Alias' :
  apache_version => '2.2',
  icons_options  => 'Indexes MultiViews',
}

class { 'Apache::Mod::Authn_core' :
  apache_version => '2.2',
}

class { 'Apache::Mod::Authn_file' :
}

class { 'Apache::Mod::Authz_default' :
}

class { 'Apache::Mod::Authz_user' :
}

class { 'Apache::Mod::Autoindex' :
}

class { 'Apache::Mod::Cache' :
}

class { 'Apache::Mod::Dav' :
  before => 'Class[Apache::Mod::Dav_fs]',
}

class { 'Apache::Mod::Dav_fs' :
}

class { 'Apache::Mod::Deflate' :
  notes => { 'Input' => 'instream', 'Output' => 'outstream', 'Ratio' => 'ratio' },
  types => [ 'text/html text/plain text/xml', 'text/css', 'application/x-javascript application/javascript application/ecmascript', 'application/rss+xml' ],
}

class { 'Apache::Mod::Dir' :
  dir     => 'public_html',
  indexes => [ 'index.html', 'index.html.var', 'index.cgi', 'index.pl', 'index.php', 'index.xhtml' ],
}

class { 'Apache::Mod::Headers' :
}

class { 'Apache::Mod::Mime' :
  mime_support_package => 'mailcap',
  mime_types_config    => '/etc/mime.types',
}

class { 'Apache::Mod::Mime_magic' :
  magic_file => '/etc/httpd/conf/magic',
}

class { 'Apache::Mod::Negotiation' :
  force_language_priority => 'Prefer Fallback',
  language_priority       => [ 'en', 'ca', 'cs', 'da', 'de', 'el', 'eo', 'es', 'et', 'fr', 'he', 'hr', 'it', 'ja', 'ko', 'ltz', 'nl', 'nn', 'no', 'pl', 'pt', 'pt-BR', 'ru', 'sv', 'zh-CN', 'zh-TW' ],
}

class { 'Apache::Mod::Rewrite' :
}

class { 'Apache::Mod::Setenvif' :
}

class { 'Apache::Mod::Speling' :
}

class { 'Apache::Mod::Suexec' :
}

class { 'Apache::Mod::Version' :
  apache_version => '2.2',
}

class { 'Apache::Mod::Vhost_alias' :
}

class { 'Apache::Mod::Wsgi' :
  wsgi_socket_prefix => '/var/run/wsgi',
}

class { 'Apache::Params' :
}

class { 'Apache::Service' :
  service_enable => true,
  service_ensure => 'running',
  service_manage => true,
  service_name   => 'httpd',
}

class { 'Apache::Version' :
}

class { 'Apache' :
  apache_name            => 'httpd',
  apache_version         => '2.2',
  conf_dir               => '/etc/httpd/conf',
  conf_template          => 'apache/httpd.conf.erb',
  confd_dir              => '/etc/httpd/conf.d',
  default_confd_files    => true,
  default_mods           => true,
  default_ssl_cert       => '/etc/pki/tls/certs/localhost.crt',
  default_ssl_key        => '/etc/pki/tls/private/localhost.key',
  default_ssl_vhost      => false,
  default_type           => 'none',
  default_vhost          => false,
  docroot                => '/var/www/html',
  error_documents        => false,
  group                  => 'apache',
  httpd_dir              => '/etc/httpd',
  keepalive              => 'Off',
  keepalive_timeout      => '15',
  lib_path               => 'modules',
  log_formats            => {  },
  log_level              => 'warn',
  logroot                => '/var/log/httpd',
  manage_group           => true,
  manage_user            => true,
  max_keepalive_requests => '100',
  mod_dir                => '/etc/httpd/conf.d',
  mpm_module             => false,
  package_ensure         => 'installed',
  ports_file             => '/etc/httpd/conf/ports.conf',
  purge_configs          => false,
  purge_vdir             => false,
  sendfile               => 'On',
  server_root            => '/etc/httpd',
  server_signature       => 'Off',
  server_tokens          => 'Prod',
  serveradmin            => 'root@localhost',
  servername             => 'node-129',
  service_enable         => true,
  service_ensure         => 'running',
  service_manage         => true,
  service_name           => 'httpd',
  timeout                => '120',
  trace_enable           => 'Off',
  use_optional_includes  => false,
  user                   => 'apache',
  vhost_dir              => '/etc/httpd/conf.d',
}

class { 'Concat::Setup' :
}

class { 'Horizon::Params' :
}

class { 'Horizon::Wsgi::Apache' :
  bind_address        => '192.168.0.3',
  extra_params        => { 'add_listen' => false, 'custom_fragment' => '
<Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    <IfModule mod_headers.c>
      # Make sure proxies don\'t deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
    </IfModule>
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

<Directory /usr/share/openstack-dashboard/static>
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access 6 month"
  </IfModule>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

', 'default_vhost' => true, 'headers' => [ 'set X-XSS-Protection "1; mode=block"', 'set X-Content-Type-Options nosniff', 'always append X-Frame-Options SAMEORIGIN' ], 'ip_based' => true, 'options' => '-Indexes', 'setenvif' => 'X-Forwarded-Proto https HTTPS=1' },
  listen_ssl          => false,
  notify              => 'Service[httpd]',
  priority            => false,
  redirect_type       => 'permanent',
  server_aliases      => 'node-129.test.domain.local',
  servername          => 'node-129.test.domain.local',
  ssl_redirect        => true,
  vhost_conf_name     => 'horizon_vhost',
  vhost_ssl_conf_name => 'horizon_ssl_vhost',
  wsgi_processes      => '4',
  wsgi_threads        => '15',
}

class { 'Horizon' :
  allowed_hosts                  => '*',
  api_result_limit               => '1000',
  api_versions                   => {  },
  bind_address                   => '192.168.0.3',
  cache_backend                  => 'django.core.cache.backends.memcached.MemcachedCache',
  cache_options                  => { 'DEAD_RETRY' => '1', 'SERVER_RETRIES' => '1', 'SOCKET_TIMEOUT' => '1' },
  cache_server_ip                => [ '192.168.0.2', '192.168.0.3', '192.168.0.4' ],
  cache_server_port              => '11211',
  cinder_options                 => {  },
  compress_offline               => true,
  configure_apache               => false,
  django_debug                   => false,
  django_session_engine          => 'django.contrib.sessions.backends.cache',
  file_upload_temp_dir           => '/tmp',
  help_url                       => 'http://docs.openstack.org',
  horizon_app_links              => false,
  hypervisor_options             => { 'enable_quotas' => false },
  keystone_default_role          => '_member_',
  keystone_multidomain_support   => false,
  keystone_url                   => 'http://192.168.0.2:5000/v2.0',
  listen_ssl                     => false,
  local_settings_template        => 'horizon/local_settings.py.erb',
  log_handler                    => 'file',
  log_level                      => 'INFO',
  neutron_options                => { 'enable_distributed_router' => true },
  overview_days_range            => '1',
  package_ensure                 => 'installed',
  redirect_type                  => 'temp',
  secret_key                     => 'dummy_secret_key',
  secure_cookies                 => false,
  server_aliases                 => 'node-129.test.domain.local',
  servername                     => 'node-129.test.domain.local',
  ssl_no_verify                  => true,
  ssl_redirect                   => true,
  tuskar_ui                      => false,
  tuskar_ui_deployment_mode      => 'scale',
  tuskar_ui_ironic_discoverd_url => 'http://127.0.0.1:5050',
}

class { 'Openstack::Horizon' :
  apache_options        => '-Indexes',
  api_result_limit      => '1000',
  before                => [ 'Haproxy_backend_status[keystone-admin]', 'Haproxy_backend_status[keystone-public]' ],
  bind_address          => '192.168.0.3',
  cache_backend         => 'django.core.cache.backends.memcached.MemcachedCache',
  cache_options         => { 'DEAD_RETRY' => '1', 'SERVER_RETRIES' => '1', 'SOCKET_TIMEOUT' => '1' },
  cache_server_ip       => [ '192.168.0.2', '192.168.0.3', '192.168.0.4' ],
  cache_server_port     => '11211',
  debug                 => false,
  django_session_engine => 'django.contrib.sessions.backends.cache',
  headers               => [ 'set X-XSS-Protection "1; mode=block"', 'set X-Content-Type-Options nosniff', 'always append X-Frame-Options SAMEORIGIN' ],
  hypervisor_options    => { 'enable_quotas' => false },
  keystone_default_role => '_member_',
  keystone_url          => 'http://192.168.0.2:5000/v2.0',
  log_handler           => 'file',
  log_level             => 'WARNING',
  neutron               => true,
  neutron_options       => { 'enable_distributed_router' => true },
  overview_days_range   => '1',
  package_ensure        => 'installed',
  secret_key            => 'dummy_secret_key',
  servername            => '10.109.1.2',
  ssl_no_verify         => true,
  use_ssl               => false,
  use_syslog            => true,
  verbose               => true,
}

class { 'Osnailyfacter::Apache' :
  listen_ports     => [ '127.0.0.1:80', '192.168.0.3:80', '10.108.0.6:8888', '192.168.0.3:5000', '192.168.0.3:35357' ],
  logrotate_rotate => '52',
  purge_configs    => false,
}

class { 'Tweaks::Apache_wrappers' :
}

concat::fragment { 'Apache ports header' :
  ensure  => 'present',
  content => '# ************************************
# Listen & NameVirtualHost resources in module puppetlabs-apache
# Managed by Puppet
# ************************************

',
  order   => '10',
  target  => '/etc/httpd/conf/ports.conf',
}

concat::fragment { 'Listen 10.108.0.6:8888' :
  ensure  => 'present',
  content => 'Listen 10.108.0.6:8888
',
  order   => '10',
  target  => '/etc/httpd/conf/ports.conf',
}

concat::fragment { 'Listen 127.0.0.1:80' :
  ensure  => 'present',
  content => 'Listen 127.0.0.1:80
',
  order   => '10',
  target  => '/etc/httpd/conf/ports.conf',
}

concat::fragment { 'Listen 192.168.0.3:35357' :
  ensure  => 'present',
  content => 'Listen 192.168.0.3:35357
',
  order   => '10',
  target  => '/etc/httpd/conf/ports.conf',
}

concat::fragment { 'Listen 192.168.0.3:5000' :
  ensure  => 'present',
  content => 'Listen 192.168.0.3:5000
',
  order   => '10',
  target  => '/etc/httpd/conf/ports.conf',
}

concat::fragment { 'Listen 192.168.0.3:80' :
  ensure  => 'present',
  content => 'Listen 192.168.0.3:80
',
  order   => '10',
  target  => '/etc/httpd/conf/ports.conf',
}

concat::fragment { 'default-access_log' :
  content => '  CustomLog "/var/log/httpd/access_log" combined
',
  order   => '100',
  target  => '15-default.conf',
}

concat::fragment { 'default-apache-header' :
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost *:80>
  ServerName default
  ServerAdmin root@localhost
',
  order   => '0',
  target  => '15-default.conf',
}

concat::fragment { 'default-directories' :
  content => '
  ## Directories, there should at least be a declaration for /var/www/html

  <Directory "/var/www/html">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  order   => '60',
  target  => '15-default.conf',
}

concat::fragment { 'default-docroot' :
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/html"
',
  order   => '10',
  target  => '15-default.conf',
}

concat::fragment { 'default-file_footer' :
  content => '</VirtualHost>
',
  order   => '999',
  target  => '15-default.conf',
}

concat::fragment { 'default-logging' :
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/default_error.log"
',
  order   => '80',
  target  => '15-default.conf',
}

concat::fragment { 'default-scriptalias' :
  content => '  ## Script alias directives
  ScriptAlias /cgi-bin "/var/www/cgi-bin"
',
  order   => '180',
  target  => '15-default.conf',
}

concat::fragment { 'default-serversignature' :
  content => '  ServerSignature Off
',
  order   => '90',
  target  => '15-default.conf',
}

concat::fragment { 'default-ssl-access_log' :
  content => '  CustomLog "/var/log/httpd/ssl_access_log" combined
',
  order   => '100',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-apache-header' :
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost *:443>
  ServerName default-ssl
  ServerAdmin root@localhost
',
  order   => '0',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-directories' :
  content => '
  ## Directories, there should at least be a declaration for /var/www/html

  <Directory "/var/www/html">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  order   => '60',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-docroot' :
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/html"
',
  order   => '10',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-file_footer' :
  content => '</VirtualHost>
',
  order   => '999',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-logging' :
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/default-ssl_error_ssl.log"
',
  order   => '80',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-scriptalias' :
  content => '  ## Script alias directives
  ScriptAlias /cgi-bin "/var/www/cgi-bin"
',
  order   => '180',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-serversignature' :
  content => '  ServerSignature Off
',
  order   => '90',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'default-ssl-ssl' :
  content => '
  ## SSL directives
  SSLEngine on
  SSLCertificateFile      "/etc/pki/tls/certs/localhost.crt"
  SSLCertificateKeyFile   "/etc/pki/tls/private/localhost.key"
  SSLCACertificatePath    "/etc/pki/tls/certs"
',
  order   => '210',
  target  => '15-default-ssl.conf',
}

concat::fragment { 'horizon_ssl_vhost-access_log' :
  content => '  CustomLog "/var/log/httpd/horizon_ssl_access.log" combined
',
  order   => '100',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-aliases' :
  content => '  ## Alias declarations for resources outside the DocumentRoot
  Alias /dashboard/static "/usr/share/openstack-dashboard/static"
',
  order   => '20',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-apache-header' :
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost 192.168.0.3:443>
  ServerName node-129.test.domain.local
',
  order   => '0',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-custom_fragment' :
  content => '
  ## Custom fragment

<Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    <IfModule mod_headers.c>
      # Make sure proxies don\'t deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
    </IfModule>
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

<Directory /usr/share/openstack-dashboard/static>
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access 6 month"
  </IfModule>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>


',
  order   => '270',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-directories' :
  content => '
  ## Directories, there should at least be a declaration for /var/www/

  <Directory "/var/www/">
    Options -Indexes
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  order   => '60',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-docroot' :
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/"
',
  order   => '10',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-file_footer' :
  content => '</VirtualHost>
',
  order   => '999',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-header' :
  content => '
  ## Header rules
  ## as per http://httpd.apache.org/docs/2.2/mod/mod_headers.html#header
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Content-Type-Options nosniff
  Header always append X-Frame-Options SAMEORIGIN
',
  order   => '240',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-logging' :
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/horizon_ssl_error.log"
',
  order   => '80',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-redirect' :
  content => '
  ## RedirectMatch rules
  RedirectMatch permanent  ^/$ /dashboard
',
  order   => '160',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-serveralias' :
  content => '
  ## Server aliases
  ServerAlias node-129.test.domain.local
',
  order   => '190',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-serversignature' :
  content => '  ServerSignature Off
',
  order   => '90',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-setenv' :
  content => '  SetEnvIf X-Forwarded-Proto https HTTPS=1
',
  order   => '200',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-ssl' :
  content => '
  ## SSL directives
  SSLEngine on
  SSLCertificateFile      "/etc/pki/tls/certs/localhost.crt"
  SSLCertificateKeyFile   "/etc/pki/tls/private/localhost.key"
  SSLCACertificatePath    "/etc/pki/tls/certs"
',
  order   => '210',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_ssl_vhost-wsgi' :
  content => '  WSGIDaemonProcess horizon-ssl group=apache processes=4 threads=15 user=apache
  WSGIProcessGroup horizon-ssl
  WSGIScriptAlias /dashboard "/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi"
',
  order   => '260',
  target  => 'horizon_ssl_vhost.conf',
}

concat::fragment { 'horizon_vhost-access_log' :
  content => '  CustomLog "/var/log/httpd/horizon_access.log" combined
',
  order   => '100',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-aliases' :
  content => '  ## Alias declarations for resources outside the DocumentRoot
  Alias /dashboard/static "/usr/share/openstack-dashboard/static"
',
  order   => '20',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-apache-header' :
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost 192.168.0.3:80>
  ServerName node-129.test.domain.local
',
  order   => '0',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-custom_fragment' :
  content => '
  ## Custom fragment

<Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    <IfModule mod_headers.c>
      # Make sure proxies don\'t deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
    </IfModule>
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

<Directory /usr/share/openstack-dashboard/static>
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access 6 month"
  </IfModule>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>


',
  order   => '270',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-directories' :
  content => '
  ## Directories, there should at least be a declaration for /var/www/

  <Directory "/var/www/">
    Options -Indexes
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  order   => '60',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-docroot' :
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/"
',
  order   => '10',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-file_footer' :
  content => '</VirtualHost>
',
  order   => '999',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-header' :
  content => '
  ## Header rules
  ## as per http://httpd.apache.org/docs/2.2/mod/mod_headers.html#header
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Content-Type-Options nosniff
  Header always append X-Frame-Options SAMEORIGIN
',
  order   => '240',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-logging' :
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/horizon_error.log"
',
  order   => '80',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-redirect' :
  content => '
  ## RedirectMatch rules
  RedirectMatch permanent  ^/$ /dashboard
',
  order   => '160',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-serveralias' :
  content => '
  ## Server aliases
  ServerAlias node-129.test.domain.local
',
  order   => '190',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-serversignature' :
  content => '  ServerSignature Off
',
  order   => '90',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-setenv' :
  content => '  SetEnvIf X-Forwarded-Proto https HTTPS=1
',
  order   => '200',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'horizon_vhost-wsgi' :
  content => '  WSGIDaemonProcess dashboard group=apache processes=4 threads=15 user=apache
  WSGIProcessGroup dashboard
  WSGIScriptAlias /dashboard "/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi"
',
  order   => '260',
  target  => 'horizon_vhost.conf',
}

concat::fragment { 'local_settings.py' :
  content => 'import os

from django.utils.translation import ugettext_lazy as _

from openstack_dashboard import exceptions

DEBUG = False
TEMPLATE_DEBUG = DEBUG

# WEBROOT is the location relative to Webserver root
# should end with a slash.
WEBROOT = \'/dashboard/\'

# Required for Django 1.5.
# If horizon is running in production (DEBUG is False), set this
# with the list of host/domain names that the application can serve.
# For more information see:
# https://docs.djangoproject.com/en/dev/ref/settings/#allowed-hosts
#ALLOWED_HOSTS = [\'horizon.example.com\', ]

ALLOWED_HOSTS = [\'*\', ]


# Set SSL proxy settings:
# For Django 1.4+ pass this header from the proxy after terminating the SSL,
# and don\'t forget to strip it from the client\'s request.
# For more information see:
# https://docs.djangoproject.com/en/1.4/ref/settings/#secure-proxy-ssl-header
# SECURE_PROXY_SSL_HEADER = (\'HTTP_X_FORWARDED_PROTOCOL\', \'https\')

# If Horizon is being served through SSL, then uncomment the following two
# settings to better secure the cookies from security exploits

#CSRF_COOKIE_SECURE = True
#SESSION_COOKIE_SECURE = True


# Overrides for OpenStack API versions. Use this setting to force the
# OpenStack dashboard to use a specfic API version for a given service API.
# NOTE: The version should be formatted as it appears in the URL for the
# service API. For example, The identity service APIs have inconsistent
# use of the decimal point, so valid options would be "2.0" or "3".
# OPENSTACK_API_VERSIONS = {
#     "identity": 3
# }



# Set this to True if running on multi-domain model. When this is enabled, it
# will require user to enter the Domain name in addition to username for login.
# OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = False


# Overrides the default domain used when running on single-domain model
# with Keystone V3. All entities will be created in the default domain.
# OPENSTACK_KEYSTONE_DEFAULT_DOMAIN = \'Default\'


# Set Console type:
# valid options would be "AUTO", "VNC" or "SPICE"
# CONSOLE_TYPE = "AUTO"

# Default OpenStack Dashboard configuration.
HORIZON_CONFIG = {
    \'dashboards\': (\'project\', \'admin\', \'settings\',),
    \'default_dashboard\': \'project\',
    \'user_home\': \'openstack_dashboard.views.get_user_home\',
    \'ajax_queue_limit\': 10,
    \'auto_fade_alerts\': {
        \'delay\': 3000,
        \'fade_duration\': 1500,
        \'types\': [\'alert-success\', \'alert-info\']
    },
    \'help_url\': "http://docs.openstack.org",
    \'exceptions\': {\'recoverable\': exceptions.RECOVERABLE,
                   \'not_found\': exceptions.NOT_FOUND,
                   \'unauthorized\': exceptions.UNAUTHORIZED},
}

# Specify a regular expression to validate user passwords.
# HORIZON_CONFIG["password_validator"] = {
#     "regex": \'.*\',
#     "help_text": _("Your password does not meet the requirements.")
# }

# Disable simplified floating IP address management for deployments with
# multiple floating IP pools or complex network requirements.
# HORIZON_CONFIG["simple_ip_management"] = False

# Turn off browser autocompletion for the login form if so desired.
# HORIZON_CONFIG["password_autocomplete"] = "off"

LOCAL_PATH = os.path.dirname(os.path.abspath(__file__))

# Set custom secret key:
# You can either set it to a specific value or you can let horizion generate a
# default secret key that is unique on this machine, e.i. regardless of the
# amount of Python WSGI workers (if used behind Apache+mod_wsgi): However, there
# may be situations where you would want to set this explicitly, e.g. when
# multiple dashboard instances are distributed on different machines (usually
# behind a load-balancer). Either you have to make sure that a session gets all
# requests routed to the same dashboard instance or you set the same SECRET_KEY
# for all of them.
# from horizon.utils import secret_key
# SECRET_KEY = secret_key.generate_or_read_from_file(os.path.join(LOCAL_PATH, \'.secret_key_store\'))
SECRET_KEY = \'dummy_secret_key\'

# We recommend you use memcached for development; otherwise after every reload
# of the django development server, you will have to login again. To use
# memcached set CACHES to something like
# CACHES = {
#    \'default\': {
#        \'BACKEND\' : \'django.core.cache.backends.memcached.MemcachedCache\',
#        \'LOCATION\' : \'127.0.0.1:11211\',
#    }
#}

CACHES = {
    \'default\': {

        \'OPTIONS\': {
                \'DEAD_RETRY\': 1,
                \'SERVER_RETRIES\': 1,
                \'SOCKET_TIMEOUT\': 1,
        },
        \'BACKEND\': \'django.core.cache.backends.memcached.MemcachedCache\',



        \'LOCATION\': [ \'192.168.0.2:11211\',\'192.168.0.3:11211\',\'192.168.0.4:11211\', ],


    }
}


SESSION_ENGINE = "django.contrib.sessions.backends.cache"


# Send email to the console by default
EMAIL_BACKEND = \'django.core.mail.backends.console.EmailBackend\'
# Or send them to /dev/null
#EMAIL_BACKEND = \'django.core.mail.backends.dummy.EmailBackend\'

# Configure these for your outgoing email host
# EMAIL_HOST = \'smtp.my-company.com\'
# EMAIL_PORT = 25
# EMAIL_HOST_USER = \'djangomail\'
# EMAIL_HOST_PASSWORD = \'top-secret!\'

# For multiple regions uncomment this configuration, and add (endpoint, title).

OPENSTACK_KEYSTONE_URL = "http://192.168.0.2:5000/v2.0"
OPENSTACK_KEYSTONE_DEFAULT_ROLE = "_member_"

# Disable SSL certificate checks (useful for self-signed certificates):
# OPENSTACK_SSL_NO_VERIFY = False

OPENSTACK_SSL_NO_VERIFY = True

# The CA certificate to use to verify SSL connections
# OPENSTACK_SSL_CACERT = \'/path/to/cacert.pem\'

# The OPENSTACK_KEYSTONE_BACKEND settings can be used to identify the
# capabilities of the auth backend for Keystone.
# If Keystone has been configured to use LDAP as the auth backend then set
# can_edit_user to False and name to \'ldap\'.
#
# TODO(tres): Remove these once Keystone has an API to identify auth backend.
OPENSTACK_KEYSTONE_BACKEND = {
    \'name\': \'native\',
    \'can_edit_user\': True,
    \'can_edit_group\': True,
    \'can_edit_project\': True,
    \'can_edit_domain\': True,
    \'can_edit_role\': True
}

# The OPENSTACK_HYPERVISOR_FEATURES settings can be used to enable optional
# services provided by hypervisors.
OPENSTACK_HYPERVISOR_FEATURES = {
    \'can_set_mount_point\': True,
    \'can_set_password\': False,
    \'enable_quotas\': False,
}

# The OPENSTACK_CINDER_FEATURES settings can be used to enable optional
# services provided by cinder that is not exposed by its extension API.
OPENSTACK_CINDER_FEATURES = {
    \'enable_backup\': False,
}

# The OPENSTACK_NEUTRON_NETWORK settings can be used to enable optional
# services provided by neutron. Options currenly available are load
# balancer service, security groups, quotas, VPN service.
# The profile_support option is used to detect if an externa lrouter can be
# configured via the dashboard. When using specific plugins the
# profile_support can be turned on if needed.
OPENSTACK_NEUTRON_NETWORK = {
    \'enable_distributed_router\': True,
    \'enable_firewall\': False,
    \'enable_ha_router\': False,
    \'enable_lb\': False,
    \'enable_quotas\': True,
    \'enable_security_group\': True,
    \'enable_vpn\': False,
    \'profile_support\': \'None\',
}

# The OPENSTACK_IMAGE_BACKEND settings can be used to customize features
# in the OpenStack Dashboard related to the Image service, such as the list
# of supported image formats.
# OPENSTACK_IMAGE_BACKEND = {
#     \'image_formats\': [
#         (\'\', \'\'),
#         (\'aki\', _(\'AKI - Amazon Kernel Image\')),
#         (\'ami\', _(\'AMI - Amazon Machine Image\')),
#         (\'ari\', _(\'ARI - Amazon Ramdisk Image\')),
#         (\'iso\', _(\'ISO - Optical Disk Image\')),
#         (\'qcow2\', _(\'QCOW2 - QEMU Emulator\')),
#         (\'raw\', _(\'Raw\')),
#         (\'vdi\', _(\'VDI\')),
#         (\'vhd\', _(\'VHD\')),
#         (\'vmdk\', _(\'VMDK\'))
#     ]
# }

# OPENSTACK_ENDPOINT_TYPE specifies the endpoint type to use for the endpoints
# in the Keystone service catalog. Use this setting when Horizon is running
# external to the OpenStack environment. The default is \'publicURL\'.
#OPENSTACK_ENDPOINT_TYPE = "publicURL"


# SECONDARY_ENDPOINT_TYPE specifies the fallback endpoint type to use in the
# case that OPENSTACK_ENDPOINT_TYPE is not present in the endpoints
# in the Keystone service catalog. Use this setting when Horizon is running
# external to the OpenStack environment. The default is None.  This
# value should differ from OPENSTACK_ENDPOINT_TYPE if used.
#SECONDARY_ENDPOINT_TYPE = "publicURL"


# The number of objects (Swift containers/objects or images) to display
# on a single page before providing a paging element (a "more" link)
# to paginate results.
API_RESULT_LIMIT = 1000
API_RESULT_PAGE_SIZE = 20

# The timezone of the server. This should correspond with the timezone
# of your entire OpenStack installation, and hopefully be in UTC.
TIME_ZONE = "UTC"

# If you have external monitoring links, eg:


# When launching an instance, the menu of available flavors is
# sorted by RAM usage, ascending.  Provide a callback method here
# (and/or a flag for reverse sort) for the sorted() method if you\'d
# like a different behaviour.  For more info, see
# http://docs.python.org/2/library/functions.html#sorted
# CREATE_INSTANCE_FLAVOR_SORT = {
#     \'key\': my_awesome_callback_method,
#     \'reverse\': False,
# }

# CUSTOM_THEME_PATH allows to set to the directory location for the
# theme (e.g., "static/themes/blue"). The path can either be
# relative to the openstack_dashboard directory or an absolute path
# to an accessible location on the file system.
# If not specified, the default CUSTOM_THEME_PATH is
# static/themes/default.


# The Horizon Policy Enforcement engine uses these values to load per service
# policy rule files. The content of these files should match the files the
# OpenStack services are using to determine role based access control in the
# target installation.

# Path to directory containing policy.json files

POLICY_FILES_PATH = \'/etc/openstack-dashboard\'

# Map of local copy of service policy files
#POLICY_FILES = {
#    \'identity\': \'keystone_policy.json\',
#    \'compute\': \'nova_policy.json\'
#}

# Trove user and database extension support. By default support for
# creating users and databases on database instances is turned on.
# To disable these extensions set the permission here to something
# unusable such as ["!"].
# TROVE_ADD_USER_PERMS = []
# TROVE_ADD_DATABASE_PERMS = []

LOGGING = {
    \'version\': 1,
    # When set to True this will disable all logging except
    # for loggers specified in this configuration dictionary. Note that
    # if nothing is specified here and disable_existing_loggers is True,
    # django.db.backends will still log unless it is disabled explicitly.
    \'disable_existing_loggers\': False,
    \'formatters\': {
        \'verbose\': {
            \'format\': \'%(asctime)s %(process)d %(levelname)s %(name)s \'
                      \'%(message)s\'
        },
        \'normal\': {
            \'format\': \'dashboard-%(name)s: %(levelname)s %(message)s\'
        },
    },
    \'handlers\': {
        \'null\': {
            \'level\': \'DEBUG\',
            \'class\': \'django.utils.log.NullHandler\',
        },
        \'console\': {
            # Set the level to "DEBUG" for verbose output logging.
            \'level\': \'INFO\',
            \'class\': \'logging.StreamHandler\',
        },
        \'file\': {
            \'level\': \'INFO\',
            \'class\': \'logging.FileHandler\',
            \'filename\': \'/var/log/horizon/horizon.log\',
            \'formatter\': \'verbose\',
        },
        \'syslog\': {
            \'level\': \'INFO\',
            \'facility\': \'local1\',
            \'class\': \'logging.handlers.SysLogHandler\',
            \'address\': \'/dev/log\',
            \'formatter\': \'normal\',
        }
    },
    \'loggers\': {
        # Logging from django.db.backends is VERY verbose, send to null
        # by default.
        \'django.db.backends\': {
            \'handlers\': [\'null\'],
            \'propagate\': False,
        },
        \'requests\': {
            \'handlers\': [\'null\'],
            \'propagate\': False,
        },
        \'horizon\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'openstack_dashboard\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'novaclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'cinderclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'keystoneclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'glanceclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'neutronclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'heatclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'ceilometerclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'troveclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'swiftclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'openstack_auth\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'nose.plugins.manager\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'django\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
    }
}

SECURITY_GROUP_RULES = {
    \'all_tcp\': {
        \'name\': \'ALL TCP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'1\',
        \'to_port\': \'65535\',
    },
    \'all_udp\': {
        \'name\': \'ALL UDP\',
        \'ip_protocol\': \'udp\',
        \'from_port\': \'1\',
        \'to_port\': \'65535\',
    },
    \'all_icmp\': {
        \'name\': \'ALL ICMP\',
        \'ip_protocol\': \'icmp\',
        \'from_port\': \'-1\',
        \'to_port\': \'-1\',
    },
    \'ssh\': {
        \'name\': \'SSH\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'22\',
        \'to_port\': \'22\',
    },
    \'smtp\': {
        \'name\': \'SMTP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'25\',
        \'to_port\': \'25\',
    },
    \'dns\': {
        \'name\': \'DNS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'53\',
        \'to_port\': \'53\',
    },
    \'http\': {
        \'name\': \'HTTP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'80\',
        \'to_port\': \'80\',
    },
    \'pop3\': {
        \'name\': \'POP3\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'110\',
        \'to_port\': \'110\',
    },
    \'imap\': {
        \'name\': \'IMAP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'143\',
        \'to_port\': \'143\',
    },
    \'ldap\': {
        \'name\': \'LDAP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'389\',
        \'to_port\': \'389\',
    },
    \'https\': {
        \'name\': \'HTTPS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'443\',
        \'to_port\': \'443\',
    },
    \'smtps\': {
        \'name\': \'SMTPS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'465\',
        \'to_port\': \'465\',
    },
    \'imaps\': {
        \'name\': \'IMAPS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'993\',
        \'to_port\': \'993\',
    },
    \'pop3s\': {
        \'name\': \'POP3S\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'995\',
        \'to_port\': \'995\',
    },
    \'ms_sql\': {
        \'name\': \'MS SQL\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'1433\',
        \'to_port\': \'1433\',
    },
    \'mysql\': {
        \'name\': \'MYSQL\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'3306\',
        \'to_port\': \'3306\',
    },
    \'rdp\': {
        \'name\': \'RDP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'3389\',
        \'to_port\': \'3389\',
    },
}

LOGIN_URL = \'/dashboard/auth/login/\'
LOGOUT_URL = \'/dashboard/auth/logout/\'
LOGIN_REDIRECT_URL = \'/dashboard\'

# The Ubuntu package includes pre-compressed JS and compiled CSS to allow
# offline compression by default.  To enable online compression, install
# the python-lesscpy package and disable the following option.
COMPRESS_OFFLINE = True

# For Glance image upload, Horizon uses the file upload support from Django
# so we add this option to change the directory where uploaded files are temporarily
# stored until they are loaded into Glance.
FILE_UPLOAD_TEMP_DIR = \'/tmp\'



# The default date range in the Overview panel meters - either <today> minus N
# days (if the value is integer N), or from the beginning of the current month
# until today (if set to None). This setting should be used to limit the amount
# of data fetched by default when rendering the Overview panel.
# OVERVIEW_DAYS_RANGE = None

OVERVIEW_DAYS_RANGE = 1

',
  order   => '50',
  target  => '/etc/openstack-dashboard/local_settings',
}

concat { '/etc/httpd/conf/ports.conf' :
  ensure         => 'present',
  backup         => 'puppet',
  ensure_newline => false,
  force          => false,
  group          => 'root',
  mode           => '0644',
  notify         => Class[Apache::Service],
  order          => 'alpha',
  owner          => 'root',
  path           => '/etc/httpd/conf/ports.conf',
  replace        => true,
  require        => Package[httpd],
  warn           => false,
}

concat { '/etc/openstack-dashboard/local_settings' :
  ensure         => 'present',
  backup         => 'puppet',
  ensure_newline => false,
  force          => false,
  mode           => '0644',
  notify         => 'Exec[refresh_horizon_django_cache]',
  order          => 'alpha',
  path           => '/etc/openstack-dashboard/local_settings',
  replace        => true,
  require        => Package[horizon],
  warn           => false,
}

concat { '15-default-ssl.conf' :
  ensure         => 'absent',
  backup         => 'puppet',
  ensure_newline => false,
  force          => false,
  group          => 'root',
  mode           => '0644',
  notify         => Class[Apache::Service],
  order          => 'numeric',
  owner          => 'root',
  path           => '/etc/httpd/conf.d/15-default-ssl.conf',
  replace        => true,
  require        => Package[httpd],
  warn           => false,
}

concat { '15-default.conf' :
  ensure         => 'absent',
  backup         => 'puppet',
  ensure_newline => false,
  force          => false,
  group          => 'root',
  mode           => '0644',
  notify         => Class[Apache::Service],
  order          => 'numeric',
  owner          => 'root',
  path           => '/etc/httpd/conf.d/15-default.conf',
  replace        => true,
  require        => Package[httpd],
  warn           => false,
}

concat { 'horizon_ssl_vhost.conf' :
  ensure         => 'absent',
  backup         => 'puppet',
  ensure_newline => false,
  force          => false,
  group          => 'root',
  mode           => '0644',
  notify         => Class[Apache::Service],
  order          => 'numeric',
  owner          => 'root',
  path           => '/etc/httpd/conf.d/horizon_ssl_vhost.conf',
  replace        => true,
  require        => Package[httpd],
  warn           => false,
}

concat { 'horizon_vhost.conf' :
  ensure         => 'present',
  backup         => 'puppet',
  ensure_newline => false,
  force          => false,
  group          => 'root',
  mode           => '0644',
  notify         => Class[Apache::Service],
  order          => 'numeric',
  owner          => 'root',
  path           => '/etc/httpd/conf.d/horizon_vhost.conf',
  replace        => true,
  require        => Package[httpd],
  warn           => false,
}

exec { 'chown_dashboard' :
  command     => 'chown -R apache:apache /usr/share/openstack-dashboard/',
  path        => [ '/usr/sbin', '/usr/bin', '/sbin', '/bin' ],
  provider    => 'shell',
  refreshonly => true,
}

exec { 'concat_/etc/httpd/conf/ports.conf' :
  alias     => 'concat_/tmp//_etc_httpd_conf_ports.conf',
  command   => '/tmp//bin/concatfragments.rb -o "/tmp//_etc_httpd_conf_ports.conf/fragments.concat.out" -d "/tmp//_etc_httpd_conf_ports.conf"',
  notify    => File[/etc/httpd/conf/ports.conf],
  require   => [ File[/tmp//_etc_httpd_conf_ports.conf], File[/tmp//_etc_httpd_conf_ports.conf/fragments], File[/tmp//_etc_httpd_conf_ports.conf/fragments.concat] ],
  subscribe => File[/tmp//_etc_httpd_conf_ports.conf],
  unless    => '/tmp//bin/concatfragments.rb -o "/tmp//_etc_httpd_conf_ports.conf/fragments.concat.out" -d "/tmp//_etc_httpd_conf_ports.conf" -t',
}

exec { 'concat_/etc/openstack-dashboard/local_settings' :
  alias     => 'concat_/tmp//_etc_openstack-dashboard_local_settings',
  command   => '/tmp//bin/concatfragments.rb -o "/tmp//_etc_openstack-dashboard_local_settings/fragments.concat.out" -d "/tmp//_etc_openstack-dashboard_local_settings"',
  notify    => File[/etc/openstack-dashboard/local_settings],
  require   => [ File[/tmp//_etc_openstack-dashboard_local_settings], File[/tmp//_etc_openstack-dashboard_local_settings/fragments], File[/tmp//_etc_openstack-dashboard_local_settings/fragments.concat] ],
  subscribe => File[/tmp//_etc_openstack-dashboard_local_settings],
  unless    => '/tmp//bin/concatfragments.rb -o "/tmp//_etc_openstack-dashboard_local_settings/fragments.concat.out" -d "/tmp//_etc_openstack-dashboard_local_settings" -t',
}

exec { 'concat_15-default-ssl.conf' :
  alias   => 'concat_/tmp//15-default-ssl.conf',
  command => 'true',
  path    => '/bin:/usr/bin',
  unless  => 'true',
}

exec { 'concat_15-default.conf' :
  alias   => 'concat_/tmp//15-default.conf',
  command => 'true',
  path    => '/bin:/usr/bin',
  unless  => 'true',
}

exec { 'concat_horizon_ssl_vhost.conf' :
  alias   => 'concat_/tmp//horizon_ssl_vhost.conf',
  command => 'true',
  path    => '/bin:/usr/bin',
  unless  => 'true',
}

exec { 'concat_horizon_vhost.conf' :
  alias     => 'concat_/tmp//horizon_vhost.conf',
  command   => '/tmp//bin/concatfragments.rb -o "/tmp//horizon_vhost.conf/fragments.concat.out" -d "/tmp//horizon_vhost.conf" -n',
  notify    => File[horizon_vhost.conf],
  require   => [ File[/tmp//horizon_vhost.conf], File[/tmp//horizon_vhost.conf/fragments], File[/tmp//horizon_vhost.conf/fragments.concat] ],
  subscribe => File[/tmp//horizon_vhost.conf],
  unless    => '/tmp//bin/concatfragments.rb -o "/tmp//horizon_vhost.conf/fragments.concat.out" -d "/tmp//horizon_vhost.conf" -n -t',
}

exec { 'mkdir /etc/httpd/conf.d' :
  creates => '/etc/httpd/conf.d',
  path    => '/bin:/sbin:/usr/bin:/usr/sbin',
  require => Package[httpd],
}

exec { 'refresh_horizon_django_cache' :
  command     => '/usr/share/openstack-dashboard/manage.py collectstatic --noinput --clear && /usr/share/openstack-dashboard/manage.py compress --force',
  notify      => 'Exec[chown_dashboard]',
  refreshonly => true,
  require     => [ Package[python-lesscpy], Package[horizon] ],
}

file { '/etc/httpd/conf.d/15-default-ssl.conf' :
  ensure => 'absent',
  backup => 'puppet',
}

file { '/etc/httpd/conf.d/15-default.conf' :
  ensure => 'absent',
  backup => 'puppet',
}

file { '/etc/httpd/conf.d/horizon_ssl_vhost.conf' :
  ensure => 'absent',
  backup => 'puppet',
}

file { '/etc/httpd/conf.d/openstack-dashboard.conf' :
  ensure  => 'present',
  content => '#
# This file has been cleaned by Puppet.
#
# OpenStack Horizon configuration has been moved to:
# - false-horizon_vhost.conf
# - false-horizon_ssl_vhost.conf
#',
  require => Package[horizon],
}

file { '/etc/httpd/conf.d' :
  ensure  => 'directory',
  notify  => Class[Apache::Service],
  purge   => false,
  recurse => true,
  require => Package[httpd],
}

file { '/etc/httpd/conf/httpd.conf' :
  ensure  => 'file',
  content => '# Security
ServerTokens Prod
ServerSignature Off
TraceEnable Off

ServerName "node-129"
ServerRoot "/etc/httpd"
PidFile run/httpd.pid
Timeout 120
KeepAlive Off
MaxKeepAliveRequests 100
KeepAliveTimeout 15

User apache
Group apache

AccessFileName .htaccess
<FilesMatch "^\.ht">
     Order allow,deny
     Deny from all
     Satisfy all
</FilesMatch>

<Directory />
  Options FollowSymLinks
  AllowOverride None
</Directory>


DefaultType none
HostnameLookups Off
ErrorLog "/var/log/httpd/error_log"
LogLevel warn
EnableSendfile On

#Listen 80


Include "/etc/httpd/conf.d/*.load"
Include "/etc/httpd/conf/ports.conf"

LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

Include "/etc/httpd/conf.d/*.conf"

',
  notify  => Class[Apache::Service],
  require => Package[httpd],
}

file { '/etc/httpd/conf/ports.conf' :
  ensure  => 'present',
  alias   => 'concat_/etc/httpd/conf/ports.conf',
  backup  => 'puppet',
  group   => 'root',
  mode    => '0644',
  owner   => 'root',
  path    => '/etc/httpd/conf/ports.conf',
  replace => true,
  source  => '/tmp//_etc_httpd_conf_ports.conf/fragments.concat.out',
}

file { '/etc/logrotate.d/apache2' :
  ensure  => 'file',
  content => '# This file managed via puppet
/var/log/apache2/*.log {
    weekly
    missingok
    rotate 52
    compress
    delaycompress
    notifempty
    create 640 root adm
    sharedscripts
    postrotate
       if /etc/init.d/apache2 status > /dev/null ; then \
           (/usr/sbin/apachectl graceful) || (/usr/sbin/apachectl restart)
       fi;
    endscript
    prerotate
        if [ -d /etc/logrotate.d/httpd-prerotate ]; then \
            run-parts /etc/logrotate.d/httpd-prerotate; \
        fi; \
    endscript
}
',
  group   => 'root',
  mode    => '0644',
  owner   => 'root',
  require => Package[httpd],
}

file { '/etc/logrotate.d/httpd-prerotate/apache2' :
  ensure  => 'file',
  content => '#!/bin/sh
# This is a prerotate script for apache2 that will add a delay to the log
# rotation to spread out the apache2 restarts. The goal of this script is to
# stager the apache restarts to prevent all services from being down at the
# same time. LP#1491576

sleep 0
',
  group   => 'root',
  mode    => '0755',
  owner   => 'root',
}

file { '/etc/logrotate.d/httpd-prerotate' :
  ensure => 'directory',
  group  => 'root',
  mode   => '0755',
  owner  => 'root',
}

file { '/etc/openstack-dashboard/local_settings' :
  ensure  => 'present',
  alias   => 'concat_/etc/openstack-dashboard/local_settings',
  backup  => 'puppet',
  mode    => '0644',
  notify  => 'Service[httpd]',
  path    => '/etc/openstack-dashboard/local_settings',
  replace => true,
  source  => '/tmp//_etc_openstack-dashboard_local_settings/fragments.concat.out',
}

file { '/tmp//15-default-ssl.conf/fragments.concat.out' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//15-default-ssl.conf/fragments.concat' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//15-default-ssl.conf/fragments/0_default-ssl-apache-header' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-apache-header',
  backup  => 'puppet',
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost *:443>
  ServerName default-ssl
  ServerAdmin root@localhost
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/100_default-ssl-access_log' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-access_log',
  backup  => 'puppet',
  content => '  CustomLog "/var/log/httpd/ssl_access_log" combined
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/10_default-ssl-docroot' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-docroot',
  backup  => 'puppet',
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/html"
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/180_default-ssl-scriptalias' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-scriptalias',
  backup  => 'puppet',
  content => '  ## Script alias directives
  ScriptAlias /cgi-bin "/var/www/cgi-bin"
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/210_default-ssl-ssl' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-ssl',
  backup  => 'puppet',
  content => '
  ## SSL directives
  SSLEngine on
  SSLCertificateFile      "/etc/pki/tls/certs/localhost.crt"
  SSLCertificateKeyFile   "/etc/pki/tls/private/localhost.key"
  SSLCACertificatePath    "/etc/pki/tls/certs"
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/60_default-ssl-directories' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-directories',
  backup  => 'puppet',
  content => '
  ## Directories, there should at least be a declaration for /var/www/html

  <Directory "/var/www/html">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/80_default-ssl-logging' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-logging',
  backup  => 'puppet',
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/default-ssl_error_ssl.log"
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/90_default-ssl-serversignature' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-serversignature',
  backup  => 'puppet',
  content => '  ServerSignature Off
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments/999_default-ssl-file_footer' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-ssl-file_footer',
  backup  => 'puppet',
  content => '</VirtualHost>
',
  mode    => '0640',
  notify  => Exec[concat_15-default-ssl.conf],
  replace => true,
}

file { '/tmp//15-default-ssl.conf/fragments' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//15-default-ssl.conf' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//15-default.conf/fragments.concat.out' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//15-default.conf/fragments.concat' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//15-default.conf/fragments/0_default-apache-header' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-apache-header',
  backup  => 'puppet',
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost *:80>
  ServerName default
  ServerAdmin root@localhost
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments/100_default-access_log' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-access_log',
  backup  => 'puppet',
  content => '  CustomLog "/var/log/httpd/access_log" combined
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments/10_default-docroot' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-docroot',
  backup  => 'puppet',
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/html"
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments/180_default-scriptalias' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-scriptalias',
  backup  => 'puppet',
  content => '  ## Script alias directives
  ScriptAlias /cgi-bin "/var/www/cgi-bin"
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments/60_default-directories' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-directories',
  backup  => 'puppet',
  content => '
  ## Directories, there should at least be a declaration for /var/www/html

  <Directory "/var/www/html">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments/80_default-logging' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-logging',
  backup  => 'puppet',
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/default_error.log"
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments/90_default-serversignature' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-serversignature',
  backup  => 'puppet',
  content => '  ServerSignature Off
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments/999_default-file_footer' :
  ensure  => 'absent',
  alias   => 'concat_fragment_default-file_footer',
  backup  => 'puppet',
  content => '</VirtualHost>
',
  mode    => '0640',
  notify  => Exec[concat_15-default.conf],
  replace => true,
}

file { '/tmp//15-default.conf/fragments' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//15-default.conf' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments.concat.out' :
  ensure => 'present',
  backup => 'puppet',
  mode   => '0640',
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments.concat' :
  ensure => 'present',
  backup => 'puppet',
  mode   => '0640',
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments/10_Apache ports header' :
  ensure  => 'file',
  alias   => 'concat_fragment_Apache ports header',
  backup  => 'puppet',
  content => '# ************************************
# Listen & NameVirtualHost resources in module puppetlabs-apache
# Managed by Puppet
# ************************************

',
  mode    => '0640',
  notify  => Exec[concat_/etc/httpd/conf/ports.conf],
  replace => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments/10_Listen 10.108.0.6_8888' :
  ensure  => 'file',
  alias   => 'concat_fragment_Listen 10.108.0.6:8888',
  backup  => 'puppet',
  content => 'Listen 10.108.0.6:8888
',
  mode    => '0640',
  notify  => Exec[concat_/etc/httpd/conf/ports.conf],
  replace => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments/10_Listen 127.0.0.1_80' :
  ensure  => 'file',
  alias   => 'concat_fragment_Listen 127.0.0.1:80',
  backup  => 'puppet',
  content => 'Listen 127.0.0.1:80
',
  mode    => '0640',
  notify  => Exec[concat_/etc/httpd/conf/ports.conf],
  replace => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments/10_Listen 192.168.0.3_35357' :
  ensure  => 'file',
  alias   => 'concat_fragment_Listen 192.168.0.3:35357',
  backup  => 'puppet',
  content => 'Listen 192.168.0.3:35357
',
  mode    => '0640',
  notify  => Exec[concat_/etc/httpd/conf/ports.conf],
  replace => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments/10_Listen 192.168.0.3_5000' :
  ensure  => 'file',
  alias   => 'concat_fragment_Listen 192.168.0.3:5000',
  backup  => 'puppet',
  content => 'Listen 192.168.0.3:5000
',
  mode    => '0640',
  notify  => Exec[concat_/etc/httpd/conf/ports.conf],
  replace => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments/10_Listen 192.168.0.3_80' :
  ensure  => 'file',
  alias   => 'concat_fragment_Listen 192.168.0.3:80',
  backup  => 'puppet',
  content => 'Listen 192.168.0.3:80
',
  mode    => '0640',
  notify  => Exec[concat_/etc/httpd/conf/ports.conf],
  replace => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf/fragments' :
  ensure  => 'directory',
  backup  => 'puppet',
  force   => true,
  ignore  => [ '.svn', '.git', '.gitignore' ],
  mode    => '0750',
  notify  => Exec[concat_/etc/httpd/conf/ports.conf],
  purge   => true,
  recurse => true,
}

file { '/tmp//_etc_httpd_conf_ports.conf' :
  ensure => 'directory',
  backup => 'puppet',
  mode   => '0750',
}

file { '/tmp//_etc_openstack-dashboard_local_settings/fragments.concat.out' :
  ensure => 'present',
  backup => 'puppet',
  mode   => '0640',
}

file { '/tmp//_etc_openstack-dashboard_local_settings/fragments.concat' :
  ensure => 'present',
  backup => 'puppet',
  mode   => '0640',
}

file { '/tmp//_etc_openstack-dashboard_local_settings/fragments/50_local_settings.py' :
  ensure  => 'file',
  alias   => 'concat_fragment_local_settings.py',
  backup  => 'puppet',
  content => 'import os

from django.utils.translation import ugettext_lazy as _

from openstack_dashboard import exceptions

DEBUG = False
TEMPLATE_DEBUG = DEBUG

# WEBROOT is the location relative to Webserver root
# should end with a slash.
WEBROOT = \'/dashboard/\'

# Required for Django 1.5.
# If horizon is running in production (DEBUG is False), set this
# with the list of host/domain names that the application can serve.
# For more information see:
# https://docs.djangoproject.com/en/dev/ref/settings/#allowed-hosts
#ALLOWED_HOSTS = [\'horizon.example.com\', ]

ALLOWED_HOSTS = [\'*\', ]


# Set SSL proxy settings:
# For Django 1.4+ pass this header from the proxy after terminating the SSL,
# and don\'t forget to strip it from the client\'s request.
# For more information see:
# https://docs.djangoproject.com/en/1.4/ref/settings/#secure-proxy-ssl-header
# SECURE_PROXY_SSL_HEADER = (\'HTTP_X_FORWARDED_PROTOCOL\', \'https\')

# If Horizon is being served through SSL, then uncomment the following two
# settings to better secure the cookies from security exploits

#CSRF_COOKIE_SECURE = True
#SESSION_COOKIE_SECURE = True


# Overrides for OpenStack API versions. Use this setting to force the
# OpenStack dashboard to use a specfic API version for a given service API.
# NOTE: The version should be formatted as it appears in the URL for the
# service API. For example, The identity service APIs have inconsistent
# use of the decimal point, so valid options would be "2.0" or "3".
# OPENSTACK_API_VERSIONS = {
#     "identity": 3
# }



# Set this to True if running on multi-domain model. When this is enabled, it
# will require user to enter the Domain name in addition to username for login.
# OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = False


# Overrides the default domain used when running on single-domain model
# with Keystone V3. All entities will be created in the default domain.
# OPENSTACK_KEYSTONE_DEFAULT_DOMAIN = \'Default\'


# Set Console type:
# valid options would be "AUTO", "VNC" or "SPICE"
# CONSOLE_TYPE = "AUTO"

# Default OpenStack Dashboard configuration.
HORIZON_CONFIG = {
    \'dashboards\': (\'project\', \'admin\', \'settings\',),
    \'default_dashboard\': \'project\',
    \'user_home\': \'openstack_dashboard.views.get_user_home\',
    \'ajax_queue_limit\': 10,
    \'auto_fade_alerts\': {
        \'delay\': 3000,
        \'fade_duration\': 1500,
        \'types\': [\'alert-success\', \'alert-info\']
    },
    \'help_url\': "http://docs.openstack.org",
    \'exceptions\': {\'recoverable\': exceptions.RECOVERABLE,
                   \'not_found\': exceptions.NOT_FOUND,
                   \'unauthorized\': exceptions.UNAUTHORIZED},
}

# Specify a regular expression to validate user passwords.
# HORIZON_CONFIG["password_validator"] = {
#     "regex": \'.*\',
#     "help_text": _("Your password does not meet the requirements.")
# }

# Disable simplified floating IP address management for deployments with
# multiple floating IP pools or complex network requirements.
# HORIZON_CONFIG["simple_ip_management"] = False

# Turn off browser autocompletion for the login form if so desired.
# HORIZON_CONFIG["password_autocomplete"] = "off"

LOCAL_PATH = os.path.dirname(os.path.abspath(__file__))

# Set custom secret key:
# You can either set it to a specific value or you can let horizion generate a
# default secret key that is unique on this machine, e.i. regardless of the
# amount of Python WSGI workers (if used behind Apache+mod_wsgi): However, there
# may be situations where you would want to set this explicitly, e.g. when
# multiple dashboard instances are distributed on different machines (usually
# behind a load-balancer). Either you have to make sure that a session gets all
# requests routed to the same dashboard instance or you set the same SECRET_KEY
# for all of them.
# from horizon.utils import secret_key
# SECRET_KEY = secret_key.generate_or_read_from_file(os.path.join(LOCAL_PATH, \'.secret_key_store\'))
SECRET_KEY = \'dummy_secret_key\'

# We recommend you use memcached for development; otherwise after every reload
# of the django development server, you will have to login again. To use
# memcached set CACHES to something like
# CACHES = {
#    \'default\': {
#        \'BACKEND\' : \'django.core.cache.backends.memcached.MemcachedCache\',
#        \'LOCATION\' : \'127.0.0.1:11211\',
#    }
#}

CACHES = {
    \'default\': {

        \'OPTIONS\': {
                \'DEAD_RETRY\': 1,
                \'SERVER_RETRIES\': 1,
                \'SOCKET_TIMEOUT\': 1,
        },
        \'BACKEND\': \'django.core.cache.backends.memcached.MemcachedCache\',



        \'LOCATION\': [ \'192.168.0.2:11211\',\'192.168.0.3:11211\',\'192.168.0.4:11211\', ],


    }
}


SESSION_ENGINE = "django.contrib.sessions.backends.cache"


# Send email to the console by default
EMAIL_BACKEND = \'django.core.mail.backends.console.EmailBackend\'
# Or send them to /dev/null
#EMAIL_BACKEND = \'django.core.mail.backends.dummy.EmailBackend\'

# Configure these for your outgoing email host
# EMAIL_HOST = \'smtp.my-company.com\'
# EMAIL_PORT = 25
# EMAIL_HOST_USER = \'djangomail\'
# EMAIL_HOST_PASSWORD = \'top-secret!\'

# For multiple regions uncomment this configuration, and add (endpoint, title).

OPENSTACK_KEYSTONE_URL = "http://192.168.0.2:5000/v2.0"
OPENSTACK_KEYSTONE_DEFAULT_ROLE = "_member_"

# Disable SSL certificate checks (useful for self-signed certificates):
# OPENSTACK_SSL_NO_VERIFY = False

OPENSTACK_SSL_NO_VERIFY = True

# The CA certificate to use to verify SSL connections
# OPENSTACK_SSL_CACERT = \'/path/to/cacert.pem\'

# The OPENSTACK_KEYSTONE_BACKEND settings can be used to identify the
# capabilities of the auth backend for Keystone.
# If Keystone has been configured to use LDAP as the auth backend then set
# can_edit_user to False and name to \'ldap\'.
#
# TODO(tres): Remove these once Keystone has an API to identify auth backend.
OPENSTACK_KEYSTONE_BACKEND = {
    \'name\': \'native\',
    \'can_edit_user\': True,
    \'can_edit_group\': True,
    \'can_edit_project\': True,
    \'can_edit_domain\': True,
    \'can_edit_role\': True
}

# The OPENSTACK_HYPERVISOR_FEATURES settings can be used to enable optional
# services provided by hypervisors.
OPENSTACK_HYPERVISOR_FEATURES = {
    \'can_set_mount_point\': True,
    \'can_set_password\': False,
    \'enable_quotas\': False,
}

# The OPENSTACK_CINDER_FEATURES settings can be used to enable optional
# services provided by cinder that is not exposed by its extension API.
OPENSTACK_CINDER_FEATURES = {
    \'enable_backup\': False,
}

# The OPENSTACK_NEUTRON_NETWORK settings can be used to enable optional
# services provided by neutron. Options currenly available are load
# balancer service, security groups, quotas, VPN service.
# The profile_support option is used to detect if an externa lrouter can be
# configured via the dashboard. When using specific plugins the
# profile_support can be turned on if needed.
OPENSTACK_NEUTRON_NETWORK = {
    \'enable_distributed_router\': True,
    \'enable_firewall\': False,
    \'enable_ha_router\': False,
    \'enable_lb\': False,
    \'enable_quotas\': True,
    \'enable_security_group\': True,
    \'enable_vpn\': False,
    \'profile_support\': \'None\',
}

# The OPENSTACK_IMAGE_BACKEND settings can be used to customize features
# in the OpenStack Dashboard related to the Image service, such as the list
# of supported image formats.
# OPENSTACK_IMAGE_BACKEND = {
#     \'image_formats\': [
#         (\'\', \'\'),
#         (\'aki\', _(\'AKI - Amazon Kernel Image\')),
#         (\'ami\', _(\'AMI - Amazon Machine Image\')),
#         (\'ari\', _(\'ARI - Amazon Ramdisk Image\')),
#         (\'iso\', _(\'ISO - Optical Disk Image\')),
#         (\'qcow2\', _(\'QCOW2 - QEMU Emulator\')),
#         (\'raw\', _(\'Raw\')),
#         (\'vdi\', _(\'VDI\')),
#         (\'vhd\', _(\'VHD\')),
#         (\'vmdk\', _(\'VMDK\'))
#     ]
# }

# OPENSTACK_ENDPOINT_TYPE specifies the endpoint type to use for the endpoints
# in the Keystone service catalog. Use this setting when Horizon is running
# external to the OpenStack environment. The default is \'publicURL\'.
#OPENSTACK_ENDPOINT_TYPE = "publicURL"


# SECONDARY_ENDPOINT_TYPE specifies the fallback endpoint type to use in the
# case that OPENSTACK_ENDPOINT_TYPE is not present in the endpoints
# in the Keystone service catalog. Use this setting when Horizon is running
# external to the OpenStack environment. The default is None.  This
# value should differ from OPENSTACK_ENDPOINT_TYPE if used.
#SECONDARY_ENDPOINT_TYPE = "publicURL"


# The number of objects (Swift containers/objects or images) to display
# on a single page before providing a paging element (a "more" link)
# to paginate results.
API_RESULT_LIMIT = 1000
API_RESULT_PAGE_SIZE = 20

# The timezone of the server. This should correspond with the timezone
# of your entire OpenStack installation, and hopefully be in UTC.
TIME_ZONE = "UTC"

# If you have external monitoring links, eg:


# When launching an instance, the menu of available flavors is
# sorted by RAM usage, ascending.  Provide a callback method here
# (and/or a flag for reverse sort) for the sorted() method if you\'d
# like a different behaviour.  For more info, see
# http://docs.python.org/2/library/functions.html#sorted
# CREATE_INSTANCE_FLAVOR_SORT = {
#     \'key\': my_awesome_callback_method,
#     \'reverse\': False,
# }

# CUSTOM_THEME_PATH allows to set to the directory location for the
# theme (e.g., "static/themes/blue"). The path can either be
# relative to the openstack_dashboard directory or an absolute path
# to an accessible location on the file system.
# If not specified, the default CUSTOM_THEME_PATH is
# static/themes/default.


# The Horizon Policy Enforcement engine uses these values to load per service
# policy rule files. The content of these files should match the files the
# OpenStack services are using to determine role based access control in the
# target installation.

# Path to directory containing policy.json files

POLICY_FILES_PATH = \'/etc/openstack-dashboard\'

# Map of local copy of service policy files
#POLICY_FILES = {
#    \'identity\': \'keystone_policy.json\',
#    \'compute\': \'nova_policy.json\'
#}

# Trove user and database extension support. By default support for
# creating users and databases on database instances is turned on.
# To disable these extensions set the permission here to something
# unusable such as ["!"].
# TROVE_ADD_USER_PERMS = []
# TROVE_ADD_DATABASE_PERMS = []

LOGGING = {
    \'version\': 1,
    # When set to True this will disable all logging except
    # for loggers specified in this configuration dictionary. Note that
    # if nothing is specified here and disable_existing_loggers is True,
    # django.db.backends will still log unless it is disabled explicitly.
    \'disable_existing_loggers\': False,
    \'formatters\': {
        \'verbose\': {
            \'format\': \'%(asctime)s %(process)d %(levelname)s %(name)s \'
                      \'%(message)s\'
        },
        \'normal\': {
            \'format\': \'dashboard-%(name)s: %(levelname)s %(message)s\'
        },
    },
    \'handlers\': {
        \'null\': {
            \'level\': \'DEBUG\',
            \'class\': \'django.utils.log.NullHandler\',
        },
        \'console\': {
            # Set the level to "DEBUG" for verbose output logging.
            \'level\': \'INFO\',
            \'class\': \'logging.StreamHandler\',
        },
        \'file\': {
            \'level\': \'INFO\',
            \'class\': \'logging.FileHandler\',
            \'filename\': \'/var/log/horizon/horizon.log\',
            \'formatter\': \'verbose\',
        },
        \'syslog\': {
            \'level\': \'INFO\',
            \'facility\': \'local1\',
            \'class\': \'logging.handlers.SysLogHandler\',
            \'address\': \'/dev/log\',
            \'formatter\': \'normal\',
        }
    },
    \'loggers\': {
        # Logging from django.db.backends is VERY verbose, send to null
        # by default.
        \'django.db.backends\': {
            \'handlers\': [\'null\'],
            \'propagate\': False,
        },
        \'requests\': {
            \'handlers\': [\'null\'],
            \'propagate\': False,
        },
        \'horizon\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'openstack_dashboard\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'novaclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'cinderclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'keystoneclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'glanceclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'neutronclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'heatclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'ceilometerclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'troveclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'swiftclient\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'openstack_auth\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'nose.plugins.manager\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
        \'django\': {
            # \'handlers\': [\'console\'],
            \'handlers\': [\'file\'],
            # \'level\': \'DEBUG\',
            \'level\': \'INFO\',
            \'propagate\': False,
        },
    }
}

SECURITY_GROUP_RULES = {
    \'all_tcp\': {
        \'name\': \'ALL TCP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'1\',
        \'to_port\': \'65535\',
    },
    \'all_udp\': {
        \'name\': \'ALL UDP\',
        \'ip_protocol\': \'udp\',
        \'from_port\': \'1\',
        \'to_port\': \'65535\',
    },
    \'all_icmp\': {
        \'name\': \'ALL ICMP\',
        \'ip_protocol\': \'icmp\',
        \'from_port\': \'-1\',
        \'to_port\': \'-1\',
    },
    \'ssh\': {
        \'name\': \'SSH\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'22\',
        \'to_port\': \'22\',
    },
    \'smtp\': {
        \'name\': \'SMTP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'25\',
        \'to_port\': \'25\',
    },
    \'dns\': {
        \'name\': \'DNS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'53\',
        \'to_port\': \'53\',
    },
    \'http\': {
        \'name\': \'HTTP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'80\',
        \'to_port\': \'80\',
    },
    \'pop3\': {
        \'name\': \'POP3\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'110\',
        \'to_port\': \'110\',
    },
    \'imap\': {
        \'name\': \'IMAP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'143\',
        \'to_port\': \'143\',
    },
    \'ldap\': {
        \'name\': \'LDAP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'389\',
        \'to_port\': \'389\',
    },
    \'https\': {
        \'name\': \'HTTPS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'443\',
        \'to_port\': \'443\',
    },
    \'smtps\': {
        \'name\': \'SMTPS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'465\',
        \'to_port\': \'465\',
    },
    \'imaps\': {
        \'name\': \'IMAPS\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'993\',
        \'to_port\': \'993\',
    },
    \'pop3s\': {
        \'name\': \'POP3S\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'995\',
        \'to_port\': \'995\',
    },
    \'ms_sql\': {
        \'name\': \'MS SQL\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'1433\',
        \'to_port\': \'1433\',
    },
    \'mysql\': {
        \'name\': \'MYSQL\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'3306\',
        \'to_port\': \'3306\',
    },
    \'rdp\': {
        \'name\': \'RDP\',
        \'ip_protocol\': \'tcp\',
        \'from_port\': \'3389\',
        \'to_port\': \'3389\',
    },
}

LOGIN_URL = \'/dashboard/auth/login/\'
LOGOUT_URL = \'/dashboard/auth/logout/\'
LOGIN_REDIRECT_URL = \'/dashboard\'

# The Ubuntu package includes pre-compressed JS and compiled CSS to allow
# offline compression by default.  To enable online compression, install
# the python-lesscpy package and disable the following option.
COMPRESS_OFFLINE = True

# For Glance image upload, Horizon uses the file upload support from Django
# so we add this option to change the directory where uploaded files are temporarily
# stored until they are loaded into Glance.
FILE_UPLOAD_TEMP_DIR = \'/tmp\'



# The default date range in the Overview panel meters - either <today> minus N
# days (if the value is integer N), or from the beginning of the current month
# until today (if set to None). This setting should be used to limit the amount
# of data fetched by default when rendering the Overview panel.
# OVERVIEW_DAYS_RANGE = None

OVERVIEW_DAYS_RANGE = 1

',
  mode    => '0640',
  notify  => Exec[concat_/etc/openstack-dashboard/local_settings],
  replace => true,
}

file { '/tmp//_etc_openstack-dashboard_local_settings/fragments' :
  ensure  => 'directory',
  backup  => 'puppet',
  force   => true,
  ignore  => [ '.svn', '.git', '.gitignore' ],
  mode    => '0750',
  notify  => Exec[concat_/etc/openstack-dashboard/local_settings],
  purge   => true,
  recurse => true,
}

file { '/tmp//_etc_openstack-dashboard_local_settings' :
  ensure => 'directory',
  backup => 'puppet',
  mode   => '0750',
}

file { '/tmp//bin/concatfragments.rb' :
  ensure => 'file',
  backup => 'puppet',
  mode   => '0755',
  source => 'puppet:///modules/concat/concatfragments.rb',
}

file { '/tmp//bin' :
  ensure => 'directory',
  backup => 'puppet',
  mode   => '0755',
}

file { '/tmp//horizon_ssl_vhost.conf/fragments.concat.out' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments.concat' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/0_horizon_ssl_vhost-apache-header' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-apache-header',
  backup  => 'puppet',
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost 192.168.0.3:443>
  ServerName node-129.test.domain.local
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/100_horizon_ssl_vhost-access_log' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-access_log',
  backup  => 'puppet',
  content => '  CustomLog "/var/log/httpd/horizon_ssl_access.log" combined
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/10_horizon_ssl_vhost-docroot' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-docroot',
  backup  => 'puppet',
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/160_horizon_ssl_vhost-redirect' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-redirect',
  backup  => 'puppet',
  content => '
  ## RedirectMatch rules
  RedirectMatch permanent  ^/$ /dashboard
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/190_horizon_ssl_vhost-serveralias' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-serveralias',
  backup  => 'puppet',
  content => '
  ## Server aliases
  ServerAlias node-129.test.domain.local
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/200_horizon_ssl_vhost-setenv' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-setenv',
  backup  => 'puppet',
  content => '  SetEnvIf X-Forwarded-Proto https HTTPS=1
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/20_horizon_ssl_vhost-aliases' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-aliases',
  backup  => 'puppet',
  content => '  ## Alias declarations for resources outside the DocumentRoot
  Alias /dashboard/static "/usr/share/openstack-dashboard/static"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/210_horizon_ssl_vhost-ssl' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-ssl',
  backup  => 'puppet',
  content => '
  ## SSL directives
  SSLEngine on
  SSLCertificateFile      "/etc/pki/tls/certs/localhost.crt"
  SSLCertificateKeyFile   "/etc/pki/tls/private/localhost.key"
  SSLCACertificatePath    "/etc/pki/tls/certs"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/240_horizon_ssl_vhost-header' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-header',
  backup  => 'puppet',
  content => '
  ## Header rules
  ## as per http://httpd.apache.org/docs/2.2/mod/mod_headers.html#header
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Content-Type-Options nosniff
  Header always append X-Frame-Options SAMEORIGIN
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/260_horizon_ssl_vhost-wsgi' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-wsgi',
  backup  => 'puppet',
  content => '  WSGIDaemonProcess horizon-ssl group=apache processes=4 threads=15 user=apache
  WSGIProcessGroup horizon-ssl
  WSGIScriptAlias /dashboard "/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/270_horizon_ssl_vhost-custom_fragment' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-custom_fragment',
  backup  => 'puppet',
  content => '
  ## Custom fragment

<Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    <IfModule mod_headers.c>
      # Make sure proxies don\'t deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
    </IfModule>
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

<Directory /usr/share/openstack-dashboard/static>
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access 6 month"
  </IfModule>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>


',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/60_horizon_ssl_vhost-directories' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-directories',
  backup  => 'puppet',
  content => '
  ## Directories, there should at least be a declaration for /var/www/

  <Directory "/var/www/">
    Options -Indexes
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/80_horizon_ssl_vhost-logging' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-logging',
  backup  => 'puppet',
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/horizon_ssl_error.log"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/90_horizon_ssl_vhost-serversignature' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-serversignature',
  backup  => 'puppet',
  content => '  ServerSignature Off
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments/999_horizon_ssl_vhost-file_footer' :
  ensure  => 'absent',
  alias   => 'concat_fragment_horizon_ssl_vhost-file_footer',
  backup  => 'puppet',
  content => '</VirtualHost>
',
  mode    => '0640',
  notify  => Exec[concat_horizon_ssl_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_ssl_vhost.conf/fragments' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//horizon_ssl_vhost.conf' :
  ensure => 'absent',
  backup => 'puppet',
  force  => true,
}

file { '/tmp//horizon_vhost.conf/fragments.concat.out' :
  ensure => 'present',
  backup => 'puppet',
  mode   => '0640',
}

file { '/tmp//horizon_vhost.conf/fragments.concat' :
  ensure => 'present',
  backup => 'puppet',
  mode   => '0640',
}

file { '/tmp//horizon_vhost.conf/fragments/0_horizon_vhost-apache-header' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-apache-header',
  backup  => 'puppet',
  content => '# ************************************
# Vhost template in module puppetlabs-apache
# Managed by Puppet
# ************************************

<VirtualHost 192.168.0.3:80>
  ServerName node-129.test.domain.local
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/100_horizon_vhost-access_log' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-access_log',
  backup  => 'puppet',
  content => '  CustomLog "/var/log/httpd/horizon_access.log" combined
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/10_horizon_vhost-docroot' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-docroot',
  backup  => 'puppet',
  content => '
  ## Vhost docroot
  DocumentRoot "/var/www/"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/160_horizon_vhost-redirect' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-redirect',
  backup  => 'puppet',
  content => '
  ## RedirectMatch rules
  RedirectMatch permanent  ^/$ /dashboard
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/190_horizon_vhost-serveralias' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-serveralias',
  backup  => 'puppet',
  content => '
  ## Server aliases
  ServerAlias node-129.test.domain.local
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/200_horizon_vhost-setenv' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-setenv',
  backup  => 'puppet',
  content => '  SetEnvIf X-Forwarded-Proto https HTTPS=1
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/20_horizon_vhost-aliases' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-aliases',
  backup  => 'puppet',
  content => '  ## Alias declarations for resources outside the DocumentRoot
  Alias /dashboard/static "/usr/share/openstack-dashboard/static"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/240_horizon_vhost-header' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-header',
  backup  => 'puppet',
  content => '
  ## Header rules
  ## as per http://httpd.apache.org/docs/2.2/mod/mod_headers.html#header
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Content-Type-Options nosniff
  Header always append X-Frame-Options SAMEORIGIN
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/260_horizon_vhost-wsgi' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-wsgi',
  backup  => 'puppet',
  content => '  WSGIDaemonProcess dashboard group=apache processes=4 threads=15 user=apache
  WSGIProcessGroup dashboard
  WSGIScriptAlias /dashboard "/usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/270_horizon_vhost-custom_fragment' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-custom_fragment',
  backup  => 'puppet',
  content => '
  ## Custom fragment

<Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    <IfModule mod_headers.c>
      # Make sure proxies don\'t deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
    </IfModule>
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>

<Directory /usr/share/openstack-dashboard/static>
  <IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access 6 month"
  </IfModule>
  <IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
  </IfModule>

  Order allow,deny
  Allow from all
</Directory>


',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/60_horizon_vhost-directories' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-directories',
  backup  => 'puppet',
  content => '
  ## Directories, there should at least be a declaration for /var/www/

  <Directory "/var/www/">
    Options -Indexes
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/80_horizon_vhost-logging' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-logging',
  backup  => 'puppet',
  content => '
  ## Logging
  ErrorLog "/var/log/httpd/horizon_error.log"
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/90_horizon_vhost-serversignature' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-serversignature',
  backup  => 'puppet',
  content => '  ServerSignature Off
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments/999_horizon_vhost-file_footer' :
  ensure  => 'file',
  alias   => 'concat_fragment_horizon_vhost-file_footer',
  backup  => 'puppet',
  content => '</VirtualHost>
',
  mode    => '0640',
  notify  => Exec[concat_horizon_vhost.conf],
  replace => true,
}

file { '/tmp//horizon_vhost.conf/fragments' :
  ensure  => 'directory',
  backup  => 'puppet',
  force   => true,
  ignore  => [ '.svn', '.git', '.gitignore' ],
  mode    => '0750',
  notify  => Exec[concat_horizon_vhost.conf],
  purge   => true,
  recurse => true,
}

file { '/tmp//horizon_vhost.conf' :
  ensure => 'directory',
  backup => 'puppet',
  mode   => '0750',
}

file { '/tmp/' :
  ensure => 'directory',
  backup => 'puppet',
  mode   => '0755',
}

file { '/var/log/horizon/horizon.log' :
  ensure  => 'file',
  before  => Service[httpd],
  group   => 'apache',
  mode    => '0640',
  owner   => 'apache',
  require => [ File[/var/log/horizon], Package[horizon] ],
}

file { '/var/log/horizon' :
  ensure  => 'directory',
  before  => Service[httpd],
  group   => 'apache',
  mode    => '0751',
  owner   => 'apache',
  require => Package[horizon],
}

file { '/var/log/httpd' :
  ensure  => 'directory',
  before  => Concat[15-default.conf],
  require => Package[httpd],
}

file { '/var/www/' :
  ensure  => 'directory',
  before  => Concat[horizon_vhost.conf],
  group   => 'root',
  owner   => 'root',
  require => Package[httpd],
}

file { 'actions.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule actions_module modules/mod_actions.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/actions.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'alias.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => '<IfModule alias_module>
Alias /icons/ "/var/www/icons/"
<Directory "/var/www/icons">
    Options Indexes MultiViews
    AllowOverride None
     Order allow,deny
     Allow from all
</Directory>
</IfModule>
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/alias.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'alias.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule alias_module modules/mod_alias.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/alias.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'auth_basic.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule auth_basic_module modules/mod_auth_basic.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/auth_basic.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'auth_digest.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule auth_digest_module modules/mod_auth_digest.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/auth_digest.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authn_alias.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authn_alias_module modules/mod_authn_alias.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authn_alias.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authn_anon.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authn_anon_module modules/mod_authn_anon.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authn_anon.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authn_dbm.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authn_dbm_module modules/mod_authn_dbm.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authn_dbm.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authn_default.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authn_default_module modules/mod_authn_default.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authn_default.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authn_file.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authn_file_module modules/mod_authn_file.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authn_file.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authz_dbm.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authz_dbm_module modules/mod_authz_dbm.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authz_dbm.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authz_default.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authz_default_module modules/mod_authz_default.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authz_default.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authz_groupfile.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authz_groupfile.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authz_host.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authz_host_module modules/mod_authz_host.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authz_host.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authz_owner.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authz_owner_module modules/mod_authz_owner.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authz_owner.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'authz_user.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule authz_user_module modules/mod_authz_user.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/authz_user.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'autoindex.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'IndexOptions FancyIndexing VersionSort HTMLTable NameWidth=* DescriptionWidth=* Charset=UTF-8
AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip x-bzip2

AddIconByType (TXT,/icons/text.gif) text/*
AddIconByType (IMG,/icons/image2.gif) image/*
AddIconByType (SND,/icons/sound2.gif) audio/*
AddIconByType (VID,/icons/movie.gif) video/*

AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
AddIcon /icons/layout.gif .html .shtml .htm .pdf
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif /core
AddIcon (SND,/icons/sound2.gif) .ogg
AddIcon (VID,/icons/movie.gif) .ogm

AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^

AddIcon /icons/odf6odt-20x22.png .odt
AddIcon /icons/odf6ods-20x22.png .ods
AddIcon /icons/odf6odp-20x22.png .odp
AddIcon /icons/odf6odg-20x22.png .odg
AddIcon /icons/odf6odc-20x22.png .odc
AddIcon /icons/odf6odf-20x22.png .odf
AddIcon /icons/odf6odb-20x22.png .odb
AddIcon /icons/odf6odi-20x22.png .odi
AddIcon /icons/odf6odm-20x22.png .odm

AddIcon /icons/odf6ott-20x22.png .ott
AddIcon /icons/odf6ots-20x22.png .ots
AddIcon /icons/odf6otp-20x22.png .otp
AddIcon /icons/odf6otg-20x22.png .otg
AddIcon /icons/odf6otc-20x22.png .otc
AddIcon /icons/odf6otf-20x22.png .otf
AddIcon /icons/odf6oti-20x22.png .oti
AddIcon /icons/odf6oth-20x22.png .oth

DefaultIcon /icons/unknown.gif
ReadmeName README.html
HeaderName HEADER.html

IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/autoindex.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'autoindex.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule autoindex_module modules/mod_autoindex.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/autoindex.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'cache.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule cache_module modules/mod_cache.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/cache.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'dav.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule dav_module modules/mod_dav.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/dav.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'dav_fs.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'DAVLockDB "/var/lib/dav/lockdb"
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/dav_fs.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'dav_fs.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule dav_fs_module modules/mod_dav_fs.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/dav_fs.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'deflate.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/x-javascript application/javascript application/ecmascript
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/html text/plain text/xml

DeflateFilterNote Input instream
DeflateFilterNote Output outstream
DeflateFilterNote Ratio ratio
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/deflate.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'deflate.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule deflate_module modules/mod_deflate.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/deflate.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'dir.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'DirectoryIndex index.html index.html.var index.cgi index.pl index.php index.xhtml
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/dir.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'dir.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule dir_module modules/mod_dir.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/dir.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'env.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule env_module modules/mod_env.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/env.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'expires.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule expires_module modules/mod_expires.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/expires.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'ext_filter.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule ext_filter_module modules/mod_ext_filter.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/ext_filter.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'headers.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule headers_module modules/mod_headers.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/headers.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'horizon_vhost.conf' :
  ensure  => 'present',
  alias   => 'concat_horizon_vhost.conf',
  backup  => 'puppet',
  group   => 'root',
  mode    => '0644',
  owner   => 'root',
  path    => '/etc/httpd/conf.d/horizon_vhost.conf',
  replace => true,
  source  => '/tmp//horizon_vhost.conf/fragments.concat.out',
}

file { 'include.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule include_module modules/mod_include.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/include.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'log_config.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule log_config_module modules/mod_log_config.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/log_config.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'logio.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule logio_module modules/mod_logio.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/logio.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'mime.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'TypesConfig /etc/mime.types

AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddType application/x-bzip2 .bz2

AddLanguage ca .ca
AddLanguage cs .cz .cs
AddLanguage da .dk
AddLanguage de .de
AddLanguage el .el
AddLanguage en .en
AddLanguage eo .eo
AddLanguage es .es
AddLanguage et .et
AddLanguage fr .fr
AddLanguage he .he
AddLanguage hr .hr
AddLanguage it .it
AddLanguage ja .ja
AddLanguage ko .ko
AddLanguage ltz .ltz
AddLanguage nl .nl
AddLanguage nn .nn
AddLanguage no .no
AddLanguage pl .po
AddLanguage pt .pt
AddLanguage pt-BR .pt-br
AddLanguage ru .ru
AddLanguage sv .sv
AddLanguage zh-CN .zh-cn
AddLanguage zh-TW .zh-tw

AddHandler type-map var
AddType text/html .shtml
AddOutputFilter INCLUDES .shtml
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/mime.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'mime.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule mime_module modules/mod_mime.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/mime.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'mime_magic.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'MIMEMagicFile "/etc/httpd/conf/magic"
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/mime_magic.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'mime_magic.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule mime_magic_module modules/mod_mime_magic.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/mime_magic.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'negotiation.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv zh-CN zh-TW
ForceLanguagePriority Prefer Fallback
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/negotiation.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'negotiation.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule negotiation_module modules/mod_negotiation.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/negotiation.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'rewrite.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule rewrite_module modules/mod_rewrite.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/rewrite.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'setenvif.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => '#
# The following directives modify normal HTTP response behavior to
# handle known problems with browser implementations.
#
BrowserMatch "Mozilla/2" nokeepalive
BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
BrowserMatch "RealPlayer 4\.0" force-response-1.0
BrowserMatch "Java/1\.0" force-response-1.0
BrowserMatch "JDK/1\.0" force-response-1.0

#
# The following directive disables redirects on non-GET requests for
# a directory that does not include the trailing slash.  This fixes a
# problem with Microsoft WebFolders which does not appropriately handle
# redirects for folders with DAV methods.
# Same deal with Apple\'s DAV filesystem and Gnome VFS support for DAV.
#
BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
BrowserMatch "MS FrontPage" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS/1.[0123]" redirect-carefully
BrowserMatch "^gnome-vfs/1.0" redirect-carefully
BrowserMatch "^gvfs/1" redirect-carefully
BrowserMatch "^XML Spy" redirect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
BrowserMatch " Konqueror/4" redirect-carefully

<IfModule mod_ssl.c>
  BrowserMatch "MSIE [2-6]" \
    nokeepalive ssl-unclean-shutdown \
    downgrade-1.0 force-response-1.0
  # MSIE 7 and newer should be able to use keepalive
  BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown
</IfModule>
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/setenvif.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'setenvif.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule setenvif_module modules/mod_setenvif.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/setenvif.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'speling.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule speling_module modules/mod_speling.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/speling.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'substitute.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule substitute_module modules/mod_substitute.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/substitute.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'suexec.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule suexec_module modules/mod_suexec.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/suexec.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'usertrack.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule usertrack_module modules/mod_usertrack.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/usertrack.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'version.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule version_module modules/mod_version.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/version.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'vhost_alias.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule vhost_alias_module modules/mod_vhost_alias.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/vhost_alias.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

file { 'wsgi.conf' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => '# The WSGI Apache module configuration file is being
# managed by Puppet an changes will be overwritten.
<IfModule mod_wsgi.c>
  WSGISocketPrefix /var/run/wsgi
</IfModule>
',
  notify  => Class[Apache::Service],
  path    => '/etc/httpd/conf.d/wsgi.conf',
  require => Exec[mkdir /etc/httpd/conf.d],
}

file { 'wsgi.load' :
  ensure  => 'file',
  before  => File[/etc/httpd/conf.d],
  content => 'LoadModule wsgi_module modules/mod_wsgi.so
',
  group   => 'root',
  mode    => '0644',
  notify  => Class[Apache::Service],
  owner   => 'root',
  path    => '/etc/httpd/conf.d/wsgi.load',
  require => [ Package[httpd], Exec[mkdir /etc/httpd/conf.d] ],
}

group { 'apache' :
  ensure  => 'present',
  require => Package[httpd],
}

haproxy_backend_status { 'keystone-admin' :
  count => '30',
  name  => 'keystone-2',
  step  => '3',
  url   => 'http://192.168.0.2:10000/;csv',
}

haproxy_backend_status { 'keystone-public' :
  count => '30',
  name  => 'keystone-1',
  step  => '3',
  url   => 'http://192.168.0.2:10000/;csv',
}

package { 'horizon' :
  ensure => 'installed',
  before => 'Package[httpd]',
  name   => 'openstack-dashboard',
  tag    => [ 'openstack', 'horizon-package' ],
}

package { 'httpd' :
  ensure => 'installed',
  name   => 'httpd',
  notify => Class[Apache::Service],
}

package { 'mailcap' :
  ensure => 'installed',
  before => File[mime.conf],
}

package { 'mod_wsgi' :
  ensure  => 'present',
  before  => [ File[wsgi.load], 'File[wsgi.conf]' ],
  require => Package[httpd],
}

package { 'python-lesscpy' :
  ensure => 'installed',
}

service { 'httpd' :
  ensure     => 'running',
  enable     => true,
  hasrestart => true,
  name       => 'httpd',
  restart    => 'sleep 30 && apachectl graceful || apachectl restart',
}

stage { 'main' :
}

user { 'apache' :
  ensure  => 'present',
  gid     => 'apache',
  require => Package[httpd],
}

